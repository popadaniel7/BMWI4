#include "CenLoc.h"
#include "stdio.h"
#include "string.h"
#include "stdlib.h"
#include "ExtLights.h"
#include "IntLights.h"
#include "SecAlm.h"
#include "tim.h"
#include "usart.h"
#include "gpio.h"

void ExtLights_MainFunction()
{
	// check the current state of the central lock
	// if the central lock is unlocked then
	// turn on exterior lights
	// low beams and position lights on the rear
	// if the car remains unlocked for more than 10 seconds
	// turn off lights
	// if the car is locked during these 10 seconds
	// turn off lights
	// check the external input for the exterior lights
	// turn on lights according to the input

}

uint8_t ExtLights_Init()
{
	uint8_t CurrentState_LowBeamLeft = STD_LOW;
	uint8_t CurrentState_LowBeamRight = STD_LOW;
	uint8_t CurrentState_HighBeamLeft = STD_LOW;
	uint8_t CurrentState_HighBeamRight = STD_LOW;
	uint8_t CurrentState_FogLightLeft = STD_LOW;
	uint8_t CurrentState_FogLightRight = STD_LOW;
	uint8_t CurrentState_TurnSignalFrontRight = STD_LOW;
	uint8_t CurrentState_TurnSignalFrontLeft = STD_LOW;
	uint8_t CurrentState_TurnSignalRearRight = STD_LOW;
	uint8_t CurrentState_TurnSignalRearLeft = STD_LOW;
	uint8_t CurrentState_PositionLightLeft = STD_LOW;
	uint8_t CurrentState_PositionLightRight = STD_LOW;
	uint8_t CurrentState_BrakeLightLeft = STD_LOW;
	uint8_t CurrentState_BrakeLightRight = STD_LOW;
	uint8_t CurrentState_ThirdBrakeLight = STD_LOW;
	uint8_t CurrentState_ReverseLightLeft = STD_LOW;
	uint8_t CurrentState_ReverseLightRight = STD_LOW;

	return E_OK;
}
/*
 * TODO: low beams, high beams, fog lights should be on one pin instead of two
 *
 */

void ExtLights_LowBeam(uint8_t PinState)
{
	HAL_GPIO_WritePin(GPIOB, LOW_BEAM_LEFT, PinState);
	HAL_GPIO_WritePin(GPIOA, LOW_BEAM_RIGHT, PinState);
}

void ExtLights_HighBeam(uint8_t PinState)
{
	HAL_GPIO_WritePin(GPIOB, HIGH_BEAM_LEFT, PinState);
	HAL_GPIO_WritePin(GPIOC, HIGH_BEAM_RIGHT, PinState);
}

void ExtLights_FogLightFront(uint8_t PinState)
{
	HAL_GPIO_WritePin(GPIOA, FOG_LIGHT_LEFT, PinState);
	HAL_GPIO_WritePin(GPIOB, FOG_LIGHT_RIGHT, PinState);
}

void ExtLights_FogLightRear(uint8_t PinState)
{
	HAL_GPIO_WritePin(GPIOA, REAR_FOG_LIGHTS, PinState);
}


void ExtLights_TurnSignalLeft(uint8_t PinState)
{
	HAL_GPIO_WritePin(GPIOA, TURN_SIGNAL_LEFT, PinState);
}

void ExtLights_TurnSignalRight(uint8_t PinState)
{
	HAL_GPIO_WritePin(GPIOB, TURN_SIGNAL_RIGHT, PinState);
}

void ExtLights_PositionLightRear(uint8_t PinState)
{
	HAL_GPIO_WritePin(GPIOB, POSITION_LIGHTS_REAR, PinState);
}

void ExtLights_BrakeLight(uint8_t PinState)
{
	HAL_GPIO_WritePin(GPIOA, BRAKE_LIGHTS, PinState);
}

void ExtLights_ReverseLight(uint8_t PinState)
{
	HAL_GPIO_WritePin(GPIOB, REVERSE_LIGHTS, PinState);
}
