#include "BTC.h"
#include "CenLoc.h"
#include "IntLights.h"
#include "ExtLights.h"
#include "usart.h"

uint8 BtcReceivedDataOnBluetooth[BtcDataLenValue] = {STD_LOW};
uint8 BtcReceivedDataIRQ;

StdReturnType Btc_Init()
{

	BtcReceivedDataIRQ = STD_LOW;

	return E_OK;
}

StdReturnType Btc_ReturnReceivedValue()
{

	uint8 BtcRxValue = 0;

	switch(BtcRxValue)
	{
		case BtcRxCenLocOn:

			BtcCenLoc = STD_HIGH;

			break;

		case BtcRxCenLocOff:

			BtcCenLoc = STD_LOW;

			break;

		case BtcRxLowBeamOn:

			BtcLowBeam = STD_HIGH;

			break;

		case BtcRxLowBeamOff:

			BtcLowBeam = STD_LOW;

			break;

		case BtcRxHighBeamOn:

			BtcHighBeam = STD_HIGH;

			break;

		case BtcRxHighBeamOff:

			BtcHighBeam = STD_LOW;

			break;

		case BtcRxFlashHighBeamOn:

			/* to be implemented */

			break;

		case BtcRxFlashHighBeamOff:

			/* to be implemented */

			break;

		case BtcRxTurnSignalLeftOn:

			BtcTurnSignalLeft = STD_HIGH;

			break;

		case BtcRxTurnSignalLeftOff:

			BtcTurnSignalLeft = STD_LOW;

			break;

		case BtcRxTurnSignalRightOn:

			BtcTurnSignalRight = STD_HIGH;

			break;

		case BtcRxTurnSignalRightOff:

			BtcTurnSignalRight = STD_LOW;

			break;

		case BtcRxHazardLightOn:

			BtcHazardLight = STD_HIGH;

			break;

		case BtcRxHazardLightOff:

			BtcHazardLight = STD_LOW;

			break;

		case BtcRxFogLightFrontOn:

			BtcFogLightFront = STD_HIGH;

			break;

		case BtcRxFogLightFrontOff:

			BtcFogLightFront = STD_LOW;

			break;

		case BtcRxFogLightRearOn:

			BtcFogLightRear = STD_HIGH;

			break;

		case BtcRxFogLightRearOff:

			BtcFogLightRear = STD_LOW;

			break;

		case BtcRxBrakeLightsOn:

			BtcBrakeLight = STD_HIGH;

			break;

		case BtcRxBrakeLightsOff:

			BtcBrakeLight = STD_LOW;

			break;

		case BtcRxPositionRearLightsOn:

			BtcPositionLightRear = STD_HIGH;

			break;

		case BtcRxPositionRearLightsOff:

			BtcPositionLightRear = STD_LOW;

			break;

		case BtcRxInteriorLightsOn:

			BtcIntLights = STD_HIGH;

			break;

		case BtcRxInteriorLightsOff:

			BtcIntLights = STD_LOW;

			break;

		default:

			break;

	}

	return E_OK;
}

StdReturnType Btc_EnableUart()
{

	if(HAL_UART_Receive_IT(&huart1, BtcReceivedDataOnBluetooth, 254) != E_NOT_OK)
	{
		HAL_UART_Receive_IT(&huart1, BtcReceivedDataOnBluetooth, 254);
	}
	else if(HAL_UART_Receive_IT(&huart1, BtcReceivedDataOnBluetooth, 254) == E_NOT_OK)
	{
		return E_NOT_OK;
	}
	else
	{
		/* do nothing */
	}

	return E_OK;

}

void Btc_MainFunction()
{
	uint8 status;

	if(Btc_EnableUart() == E_NOT_OK)
	{
		/* set dtc */
	}
	else if(Btc_EnableUart() == E_OK)
	{
		status = E_OK;
	}
	else
	{

		/* do nothing */

	}

	if(status == E_OK)
	{
		if(Btc_ReturnReceivedValue() == E_NOT_OK)
		{
			/* set dtc */
		}
		else if(Btc_ReturnReceivedValue() == E_OK)
	}
}
